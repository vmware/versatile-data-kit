{{- if .Values.fluentd.enabled }}
apiVersion: logs.vdp.vmware.com/v1beta1
kind: FluentdConfig
metadata:
  name: {{ include "pipelines-control-service.fullname" . }}-parser
spec:
  fluentconf: | # TODO: make fluentd config configurable from Values.yml
    <filter $labels(app_kubernetes_io/name={{ include "pipelines-control-service.name" . }})>
      @type parser
      key_name log
      reserve_data true
        <parse>
          @type ltsv
        </parse>
    </filter>
    <match $labels(app_kubernetes_io/name={{ include "pipelines-control-service.name" . }})>
      @type elastic-vrli
    </match>
{{- end }}
